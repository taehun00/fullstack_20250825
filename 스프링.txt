1. model
    SQL> desc sboard1;
    Name                                      Null?    Type
    ----------------------------------------- -------- ----------------------------
    ID                                        NOT NULL NUMBER
    APP_USER_ID                               NOT NULL NUMBER
    BTITLE                                    NOT NULL VARCHAR2(1000)
    BCONTENT                                  NOT NULL CLOB
    BPASS                                     NOT NULL VARCHAR2(255)
    BFILE                                              VARCHAR2(255)
    BHIT                                               NUMBER(10)
    BIP                                       NOT NULL VARCHAR2(255)
    CREATED_AT                                         TIMESTAMP(6)

    > dto :  bfile
    > dao :  insert, update

2. view
    from : encType = "multipart/form-data"  method="post"
            <input type = "file"/>

3. controller
    pow.xml
        <!-- commons-fileupload -->
        <dependency>
            <groupId>commons-fileupload</groupId>
            <artifactId>commons-fileupload</artifactId>
            <version>1.3.1</version>
        </dependency>

        <!-- commons-io -->
        <dependency>
            <groupId>commons-io</groupId>
            <artifactId>commons-io</artifactId>
            <version>2.11.0</version>
        </dependency>

        <!-- img upload   start -->
        <!-- img upload   start -->
        <!-- https://mvnrepository.com/artifact/commons-fileupload/commons-fileupload -->
        <dependency>
            <groupId>commons-fileupload</groupId>
            <artifactId>commons-fileupload</artifactId>
            <version>1.3.1</version>
        </dependency>
        <!-- img upload end -->
        <!-- img upload end -->

    servlet-context.xml
    FileUpload.java
    Controller.java





# AJAX
1.글검색
2.아이디중복검사
3.유저 수정, 삭제

1.글검색
1)model
table, dto, dao#, service
    select * from emp where ename like '$S%';

2)controller
@RestController //@Controller + @ResponseBody


3)view(AJAX)






---------------------
#8. AOP + Mybatis
---------------------
1. AOP 개요
STEP1)
- 핵심기능 : (비지니스로직)
- 부가기능 : 핵심기능(비지니스로직)을 도와줌
>> AOP - 부가기능

  @Controller    /list.do
          ■ 부가기능                    ■ 부가기능
         [시작]-  Service  (전체리스트뽑아주는 service) -[끝]
             |  처리뷰   
             ↓
         [시작]- Repository(전체리스트뽑아주는 sql   )  -[끝]


STEP2) Aspect
- 기능분리
- 런타임 시 필요한 위치에 동적으로 처리
        Advice + PointCut = Aspect
  부가기능정의   적용부위

STEP3) 용어
Target   -  대상
Advice   -  부가기능
PointCut -  적용할 타겟의 메서드를 선별하는 정규식
Weaving  -  Target에 부가기능 처리(삽입)하는 과정


STEP4) 
<<BEFORE>>         
application         
[
 [  비지니스로직    ]
 [  보안, 인증, 로직]
]

<<AFTER>>
application         
[
 **********************           
 *[   PointCut 적용부위 ]    Weaving  →    [  비지니스로직    ]
        ↑
 *[   Advice 부가기능   ] *
       ↑
 *[  보안, 인증, 로직   ] *
 *   [Aspect]
 **********************  
]
Target   -  대상
Advice   -  부가기능
PointCut -  적용할 타겟의 메서드를 선별하는 정규식
Weaving  -  Target에 부가기능 처리(삽입)하는 과정


2. AOP 특징
>> 프록시 기반 aop를 지원
- 프록시는 advice(부가기능)을 target(대상객체)에 적용하면서 생성되는 객체
- Target(대상객체)를 감싸는 프록시는 런타임 시에 생성됨.
- 타겟객체에 대한 호출을 intercept(가로채서)해서  
  A. 부가기능 수행 후 타겟의 핵심기능 로직호출(전처리)  , 
  B. 타겟의 핵심기능 로직호출  부가기능 수행  (후처리) 
  

   호출 --->   [ Proxy  [Target]  ]

3. 구현방식
1) xml
2) annotation

실습1) pom.xml
1. AspectJ runtime   -> AspectJrt
2. AspectJ weaver    -> AspectJweaver
3. Spring aop        -> spring-aop
4. api 문서
https://www.eclipse.org/aspectj/doc/next/runtime-api/

<!-- https://mvnrepository.com/artifact/org.aspectj/aspectjrt -->
<dependency>
    <groupId>org.aspectj</groupId>
    <artifactId>aspectjrt</artifactId>
    <version>1.7.3</version>
    <!-- <scope>runtime</scope>  -->
</dependency>
<!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver -->
<dependency>
    <groupId>org.aspectj</groupId>
    <artifactId>aspectjweaver</artifactId>
    <version>1.7.3</version>
    <!-- <scope>runtime</scope> -->
</dependency>
<!-- https://mvnrepository.com/artifact/org.springframework/spring-aop -->
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-aop</artifactId>
    <version>4.3.28.RELEASE</version>
</dependency>



실습2)  Advice + PointCut = Aspect
  부가기능정의   적용부위

com.thejoa703.aop
>> AopTrace.java


import org.aspectj.lang.ProceedingJoinPoint;

public class AopTrace {
   public Object trace( ProceedingJoinPoint  joinPoint)  throws Throwable{
      // 타겟메서드의 정보
      String signature = joinPoint.getSignature().toShortString();
      System.out.println(">>>> " + signature + " START! ");
      // 타겟메서드 호출시간확인
      long start = System.currentTimeMillis();
      // 타겟메서드 호출
      Object  result = joinPoint.proceed();
      long end  = System.currentTimeMillis();
      System.out.println("..... 실행시간 : " + (end - start)  + "ms");
      System.out.println(">>>> " + signature + " END! ");
      return result;
   }
}


실습3)  servlet-context.xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:aop="http://www.springframework.org/schema/aop"
   xsi:schemaLocation="http://www.springframework.org/schema/beans    http://www.springframework.org/schema/beans/spring-beans.xsd
   http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.3.xsd">
   
   <aop:config>
      <aop:aspect  id="traceAspect"   ref="aopTrace" >
         <aop:around     method="trace"  
                    pointcut="execution(public * com.company.service..*(..))"
          />
      </aop:aspect>
   </aop:config>
   
   <!-- Advice 클래스 Bean 등록 -->
   <bean  id="aopTrace"   class="com.company.aop_xml.AopTrace" />
</beans>



Aop 설정    
   1. aop:config  aop 설정정보  -  bean
   2. aspect :  advice + point cut
   3. aop:around
   aop:around
   aop:before  실행 전
   aop:after   실행 후
   aop:after-returning   정상 실행시  
   aop:after-throwing    예외 발생시  
   
   1) exection(* hello(..) )  
      hello라는 이름 메서드 / 파라미터종류는 모두
   2) exection(* hello()   )  
      hello라는 이름 메서드 / 파라미터종류는 안됨.
   3) exection(* com.company.service.UserSeviceImpl.*(..)   )  
      UserSeviceImpl 클래스의 모든메서드
   4) exection(* com.company.service.*.*(..)   )      
      service안의 모든클래스
   5) exection(* com.company.service..*(..)   )  
      .. 서브패키지의 모든클래스  

   >> https://docs.spring.io/spring-framework/docs/2.0.x/reference/aop.html









> 주제 
■1. 주요기능 - crud
1-1. 멤버관리
             사용자측                                           관리자측
CREATE       회원가입                                           회원가입
READ         로그인/아이디찾기/비밀번호찾기/마이페이지            전체유저정보확인
UPDATE       정보수정                                      정보수정, 회원정보수정
DELETE       탈퇴                                              회원탈퇴

1-2. 퀘스트관리
              사용자측             관리자측
CREATE           X              게시판글쓰기
READ        전체읽기, 상세읽기    전체읽기, 상세읽기
UPDATE           X                글수정
DELETE           X                글삭제

■2. 흐름도 
[사용자] ── 회원가입 ──▶ DB 저장
   │
   ├─▶ 로그인 / 아이디찾기 / 비밀번호찾기 ──▶ 마이페이지 조회
   │
   ├─▶ 정보수정 ──▶ DB 업데이트
   │
   └─▶ 탈퇴 ──▶ DB 삭제

[관리자] ── 회원가입 ──▶ DB 저장
   │
   ├─▶ 전체 유저정보 확인 ──▶ DB 조회
   │
   ├─▶ 회원정보 수정 ──▶ DB 업데이트
   │
   └─▶ 회원탈퇴 ──▶ DB 삭제

